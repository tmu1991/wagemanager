<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />

	<link th:href="@{examples/jquery-calendar-150418163134/js/need/laydate.css}" rel="stylesheet"/>
	<link th:href="@{examples/jquery-calendar-150418163134/js/skins/yahui/laydate.css}" rel="stylesheet"/>
	<style type="text/css">

	*{margin:0;padding:0;list-style:none;}

	html{ font-size:14px; color:#000; font-family:'微软雅黑'}

	h2{line-height:30px; font-size:20px;}

	a,a:hover{ text-decoration:none;}

	pre{font-family:'微软雅黑'}

	.box{padding:10px; background-color:#fff; margin:10px auto;}

	.box a{padding-right:20px;}

	.demo1{margin: 20px auto;}

	h3{margin:10px 0;}

	.layinput{height: 22px;line-height: 22px;width: 150px;margin: 0;}
			table{
				width: 99%;
				border-collapse: collapse;
			}
			thead th{
				width: auto;
				height: 50px;
				border: 1px solid #000000;
			}
			tbody td{
				width: auto;
				height: 30px;
				border: 1px solid #000000;
				text-align: center;

			}

	</style>
	<link th:href="@{css/page.css}" type="text/css" rel="stylesheet">
	<script th:src="@{js/jquery.js}" type="text/javascript" charset="utf-8"></script>
	<script th:src="@{examples/js/laydate.js}" type="text/javascript"></script>
	<script th:src="@{js/paging.js}" type="text/javascript" charset="utf-8"></script>
	<script th:inline="javascript">
	$(function () {
        getDateList();
    });
	
	function getDateList(curPage,year,month) {
        var date=new Date;
        if(year===undefined){
	        year=date.getFullYear();
		}
		if(month===undefined) {
            month = date.getMonth()+1;
        }
        if(curPage===undefined){
            curPage=1;
		}
		$.ajax({
			url:"salary/history",
			type:"post",
			data:{"year":year,"month":month,"curPage":curPage},
			success:function (data) {
                var tabContent=$("#tab_content");
                tabContent.html("");
                var result=data.data;
                if(data.code===200){
					if(result===''||result===undefined||result.length===0){
						tabContent.append("<span>暂无数据</span>");
					}else{
					    $.each(result,function (i, item) {
					        var fine=item.late+item.otherDebit+item.partyDue+item.loan+item.other;
							tabContent.append("<tr><td>"+item.workNo+"</td><td>"+item.deptName+"</td><td>"+item.username+"</td><td>"+item.base+"</td><td>"+item.dailyWage+
								"<td>"+item.workTotal+"</td><td>"+item.seniority+"</td><td>"+item.subWork+"</td><td>"+item.allowance+"</td><td>"+item.grossPay+
								"</td><td>"+item.insurance+"</td><td>"+item.incomeTax+"</td></td><td>"+item.bonus+"</td><td>"+fine+"</td><td>"+item.payroll+"</td><td>"+item.creditCard+ "</td></tr>");
                        })
					}
					$("#curDate").attr("title",year+"-"+month);
					var page=data.page;
					if(page.totalCount>0){
                    $("#page").paging({
                        pageNo: curPage,
                        totalPage: page.pageCount,
                        totalSize: page.totalCount,
                        callback: function(num) {
                            getDateList(num,year,month);
                        }
                    });
                    if(curPage>=page.pageCount){
                        $("#nextPage").remove();
                        $("#lastPage").remove();
                    }
                    if(curPage<=1){
                        $("#prePage").remove();
                        $("#firstPage").remove();
                    }}
				}
            },
            error: function(data){
                alert("获取数据失败");
            }
		});
    }
    $(document).ajaxComplete(function(event,obj,settings){
        if (obj.responseText === 'invalidSession') { //超时标识
            location.href='/login'; //跳转到登录页面
        }
    })
</script>


</head>

<body>



<div class="box">



	<div class="demo1" id="curDate" title="">


		<input class="laydate-icon" id="demo" value="">

	</div>

</div>
<table>
			<!--表头-->
			<thead>
				<th>考勤编号</th>
				<th>部门</th>
				<th>姓名</th>
				<th>基本工资</th>
				<th>日工资</th>
				<th>记资天数</th>
				<th>工龄工资</th>
				<th>顶班工资</th>
				<th>津贴</th>
				<th>应发工资</th>
				<th>四险</th>
				<th>个税</th>
				<th>奖金</th>
				<th>罚金</th>
				<th>实际工资</th>
				<th>银行卡号</th>
			</thead>
			<!--内容-->
			<tbody id="tab_content">

			</tbody>
			
		</table>
	<div align="center"  value="1 0"></div>
	<div align="center" id="page" class="page_div"></div>


<script type="text/javascript" th:inline="javascript">

!function(){

	laydate.skin('molv');//切换皮肤，请查看skins下面皮肤库

	laydate({
		elem: '#demo',
        format: 'YYYY-MM',
        festival: true, //显示节日
        choose: function(datas){ //选择日期完毕的回调
			if(datas!==''){
                var year=datas.substring(0,4);
                var month=datas.substring(5,7);
                month=month.replace(/\b(0+)/gi,"");
                var curDate = $("#curDate").attr("title");
                if(curDate!==year+"-"+month){
                    getDateList(1,year,month);
                }else{
                    console.log("curDate:"+curDate);
                    console.log(year+"-"+month);
                }
			}
        }
	});//绑定元素

}();



//日期范围限制

var start = {

    elem: '#start',

    format: 'YYYY-MM-DD',

    min: laydate.now(), //设定最小日期为当前日期

    max: '2099-06-16', //最大日期

    istime: true,

    istoday: false,

    choose: function(datas){

         end.min = datas; //开始日选好后，重置结束日的最小日期

         end.start = datas //将结束日的初始值设定为开始日

    }

};



var end = {

    elem: '#end',

    format: 'YYYY-MM-DD',

    min: laydate.now(),

    max: '2099-06-16',

    istime: true,

    istoday: false,

    choose: function(datas){

        start.max = datas; //结束日选好后，充值开始日的最大日期

    }

};

laydate(start);

laydate(end);



//自定义日期格式

laydate({

    elem: '#test1',

    format: 'YYYY年MM月DD日',

    festival: true, //显示节日

    choose: function(datas){ //选择日期完毕的回调

        alert('得到：'+datas);

    }

});



//日期范围限定在昨天到明天

laydate({

    elem: '#hello3',

    min: laydate.now(-1), //-1代表昨天，-2代表前天，以此类推

    max: laydate.now(+1) //+1代表明天，+2代表后天，以此类推

});

</script>



</body>

</html>