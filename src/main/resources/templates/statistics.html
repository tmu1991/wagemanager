<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
	<head>
		<meta charset="UTF-8">
		<title></title>
		<link rel="stylesheet" th:href="@{layui/css/layui.css}" href="../static/layui/css/layui.css" media="all">
	</head>
	<body class="childrenBody">
	<div style="margin-top: 10px;margin-left: 10px;margin-right: 5px;">
		<fieldset class="layui-elem-field layui-field-title" style="margin-top: 20px;">
			<legend><span class="sum_time"></span>部门工资汇总</legend>
		</fieldset>
		<div class="layui-form news_list">
			<table class="layui-table">
			<!--表头-->
			<thead>
			<tr>
				<th>部门</th>
				<th>应发工资</th>
				<th>顶班工资</th>
				<th>津贴</th>
				<th>四险</th>
				<th>个税</th>
				<th>一金</th>
				<th>实发工资</th></tr>
			</thead>
			<!--内容-->
				<tbody class="news_content"></tbody>
			<!--合计-->
			<tfoot>
				<tr class="statistics_sum">

				</tr>
			</tfoot>
		</table>
	</div>
	</div>

	<script th:src="@{layui/layui.js}" src="../static/layui/layui.js"></script>
	<script th:inline="javascript">
        layui.use(['table','jquery'],function () {
            var $ = layui.jquery;
			$.ajax({
				url:"salary/statistics.json",
				type:"post",
				success:function (result) {
					var code = result.code,
						listData = result.data;
					if(code == 200){
						//渲染数据
						var dataHtml = '';
						var grossPay=0,subWork=0,
							allowance=0,insurance=0,
							incomeTax=0,accuFund=0,payroll=0;
						if (listData.length != 0) {
							$.each(listData,function (i, item) {
								dataHtml+="<tr>" +
									"<td>"+item.deptName+"</td>" +
									"<td>"+item.grossPay+"</td>" +
									"<td>"+item.subWork+ "</td>" +
									"<td>"+item.allowance+"</td>" +
									"<td>"+item.insurance+"</td>" +
									"<td>"+item.incomeTax+"</td>" +
									"<td>"+item.accuFund+"</td>" +
									"<td>"+item.payroll+"</td>" +
									"</tr>";
								grossPay+=item.grossPay;
								subWork+=item.subWork;
								allowance+=item.allowance;
								insurance+=item.insurance;
								incomeTax+=item.incomeTax;
								accuFund+=item.accuFund;
								payroll+=item.payroll;
							});
						}
						$(".sum_time").text(result.msg);
						$(".news_content").html(dataHtml);
						$(".statistics_sum").html("<td>合计</td><td>"+grossPay+"</td><td>"+subWork+"</td><td>"+allowance+"</td><td>"+insurance+"</td><td>"+incomeTax+"</td><td>"+accuFund+"</td><td>"+payroll+"</td>");
					}
				},
				error: function(data){
					alert("获取数据失败");
				}
			});
		});
	</script>
	</body>
</html>
